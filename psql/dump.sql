CREATE TABLE IF NOT EXISTS "Team" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255) NOT NULL UNIQUE,
	PRIMARY KEY("id")
);




CREATE TABLE IF NOT EXISTS "Student" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255) NOT NULL,
	"team_id" INTEGER NOT NULL,
	PRIMARY KEY("id")
);




CREATE TABLE IF NOT EXISTS "Service" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255) NOT NULL UNIQUE,
	"team_id" INTEGER NOT NULL,
	PRIMARY KEY("id")
);




CREATE TABLE IF NOT EXISTS "Achievement" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"name" VARCHAR(255) NOT NULL UNIQUE,
	PRIMARY KEY("id")
);




CREATE TABLE IF NOT EXISTS "AchievementTeam" (
	"team_id" INTEGER NOT NULL,
	"achievement_id" INTEGER NOT NULL,
	"timestamp" TIMESTAMP NOT NULL,
	PRIMARY KEY("team_id", "achievement_id")
);




CREATE TABLE IF NOT EXISTS "ApiKey" (
	"service_id" INTEGER NOT NULL,
	"key" VARCHAR(255) NOT NULL,
	PRIMARY KEY("service_id", "key")
);




CREATE TABLE IF NOT EXISTS "Authorization" (
	"login" VARCHAR(255) NOT NULL UNIQUE,
	"password" VARCHAR(255) NOT NULL,
	"team_id" INTEGER NOT NULL,
	PRIMARY KEY("login")
);




CREATE TABLE IF NOT EXISTS "GitCommit" (
	"id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"timestamp" TIMESTAMP NOT NULL,
	"student_id" INTEGER NOT NULL,
	"description" TEXT,
	PRIMARY KEY("id")
);



ALTER TABLE "Student"
ADD FOREIGN KEY("team_id") REFERENCES "Team"("id")
ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "Authorization"
ADD FOREIGN KEY("team_id") REFERENCES "Team"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "AchievementTeam"
ADD FOREIGN KEY("team_id") REFERENCES "Team"("id")
ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "Service"
ADD FOREIGN KEY("team_id") REFERENCES "Team"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "ApiKey"
ADD FOREIGN KEY("service_id") REFERENCES "Service"("id")
ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "AchievementTeam"
ADD FOREIGN KEY("achievement_id") REFERENCES "Achievement"("id")
ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "GitCommit"
ADD FOREIGN KEY("student_id") REFERENCES "Student"("id")
ON UPDATE CASCADE ON DELETE CASCADE;
